<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Datos desde Google Sheets</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: .5rem; text-align: left; }
    th { background: #f0f0f0; }
  </style>
</head>
<body>
  <h1>Datos del prototipo</h1>
  <div id="loading">Cargando datos…</div>
  <table id="dataTable" style="display: none;"></table>

  <script>
    const sheetId = '2PACX-1vSX9IUrV8oHTcY0xLufvuQEYb1EuwnJvF5pHHM5KnK46dQrmvfuSZsnzLHUyud0OmEyjSfbEFGrSjcj';
    const gid = '0'; // Pestaña 1 usualmente tiene gid = 0

    const query = new google.visualization.Query(
      `https://docs.google.com/spreadsheets/d/e/${sheetId}/gviz/tq?gid=${gid}`
    );

    query.send(response => {
      if (response.isError()) {
        document.getElementById('loading').innerText = 'Error al cargar los datos.';
        console.error(response.getMessage(), response.getDetailedMessage());
        return;
      }

      const data = response.getDataTable();
      const numRows = data.getNumberOfRows();
      const numCols = data.getNumberOfColumns();

      const table = document.getElementById('dataTable');
      const headerRow = table.insertRow();
      for (let col = 0; col < numCols; col++) {
        const th = document.createElement('th');
        th.innerText = data.getColumnLabel(col);
        headerRow.appendChild(th);
      }

      for (let row = 0; row < numRows; row++) {
        const tr = table.insertRow();
        for (let col = 0; col < numCols; col++) {
          const td = tr.insertCell();
          td.innerText = data.getValue(row, col);
        }
      }

      document.getElementById('loading').style.display = 'none';
      table.style.display = '';
    });
  </script>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    google.charts.load('current', {packages: ['corechart']});
    google.charts.setOnLoadCallback(() => {
      console.log('Google Visualization API lista');
    });
  </script>
</body>
</html>
